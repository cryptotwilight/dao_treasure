<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="../assets/images/favicon.svg" type="image/x-icon" />
    <title>Tresoreria - Withdrawals Manager</title>

    <!-- ========== All CSS files linkup ========= -->
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../assets/css/lineicons.css" />
    <link rel="stylesheet" href="../assets/css/materialdesignicons.min.css" />
    <link rel="stylesheet" href="../assets/css/fullcalendar.css" />
    <link rel="stylesheet" href="../assets/css/fullcalendar.css" />
    <link rel="stylesheet" href="../assets/css/main.css" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <script src="https://cdn.ethers.io/lib/ethers-5.0.umd.min.js" type="text/javascript"></script>

    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/ethjs@0.3.4/dist/ethjs.min.js"></script>
</head>

<body>
    <!-- ======== sidebar-nav start =========== -->
    <aside class="sidebar-nav-wrapper">
      <div class="navbar-logo">
          <a href="../index.html">
              <img src="../assets/images/logo/logo.svg" alt="Tresoreria" />
          </a>
      </div>
      <nav class="sidebar-nav">
          <ul>
              <li class="nav-item nav-item-has-children">
                  <a href="#0" data-bs-toggle="collapse" data-bs-target="#ddmenu_1" aria-controls="ddmenu_1" aria-expanded="false" aria-label="Toggle navigation">
                      <span class="icon">
              <svg width="22" height="22" viewBox="0 0 22 22">
                <path
                  d="M17.4167 4.58333V6.41667H13.75V4.58333H17.4167ZM8.25 4.58333V10.0833H4.58333V4.58333H8.25ZM17.4167 11.9167V17.4167H13.75V11.9167H17.4167ZM8.25 15.5833V17.4167H4.58333V15.5833H8.25ZM19.25 2.75H11.9167V8.25H19.25V2.75ZM10.0833 2.75H2.75V11.9167H10.0833V2.75ZM19.25 10.0833H11.9167V19.25H19.25V10.0833ZM10.0833 13.75H2.75V19.25H10.0833V13.75Z"
                />
              </svg>
            </span>
            <span class="text">Dashboard</span>
                  </a>
                  <ul id="ddmenu_1" class="collapse show dropdown-nav">
                      <li>
                     
                          <a href="../index.html" class="active">
                            <span class="icon">
                              <svg 
                              width="32"
                              height="32"
                              viewBox="0 0 32 32"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 6l-10-4-11 4v24l11-4 10 4 11-4v-24l-11 4zM12 4.554l8 3.2v19.692l-8-3.2v-19.692zM2 7.401l8-2.909v19.744l-8 2.909v-19.744zM30 24.599l-8 2.909v-19.744l8-2.909v19.744z"></path>
                                </svg>
                            </span> Overview </a>
                      </li>
                  </ul>
              </li>
              <li class="nav-item nav-item-has-children">
                  <a href="#0" class="collapsed" data-bs-toggle="collapse" data-bs-target="#ddmenu_2" aria-controls="ddmenu_2" aria-expanded="false" aria-label="Toggle navigation">
                      <span class="icon">
                        <svg 
                        width="32"
                        height="32"
                        viewBox="0 0 32 32"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                          <path d="M10 6c0-3.314 2.686-6 6-6s6 2.686 6 6c0 3.314-2.686 6-6 6s-6-2.686-6-6zM24.002 14h-1.107l-6.222 12.633 2.327-11.633-3-3-3 3 2.327 11.633-6.222-12.633h-1.107c-3.998 0-3.998 2.687-3.998 6v10h24v-10c0-3.313 0-6-3.998-6z"></path>
                    
                          </svg>
                          
                      </span>
                  <span class="text">Management</span>
                  </a>
                  <ul id="ddmenu_2" class="collapse dropdown-nav">
                      <li>
                          <a href="01_investments.html">
                            <span class="icon">
                              <svg 
                              width="32"
                              height="32"
                              viewBox="0 0 32 32"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg">
                                  <path d="M30 8h-8v-2c0-1.1-0.9-2-2-2h-8c-1.1 0-2 0.9-2 2v2h-8c-1.1 0-2 0.9-2 2v18c0 1.1 0.9 2 2 2h28c1.1 0 2-0.9 2-2v-18c0-1.1-0.9-2-2-2zM12 6.004c0.001-0.001 0.002-0.003 0.004-0.004h7.993c0.001 0.001 0.003 0.002 0.004 0.004v1.996h-8v-1.996zM30 16h-4v3c0 0.55-0.45 1-1 1h-2c-0.55 0-1-0.45-1-1v-3h-12v3c0 0.55-0.45 1-1 1h-2c-0.55 0-1-0.45-1-1v-3h-4v-2h28v2z"></path>
                                 
                              </svg>
                            </span> Investments </a>
                      </li>
                      <li>
                          <a href="02_deposits.html">
                            <span class="icon">
                              <svg 
                              width="32"
                              height="32"
                              viewBox="0 0 32 32"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg">
                             
                                <path d="M26 2h-20l-6 6v21c0 0.552 0.448 1 1 1h30c0.552 0 1-0.448 1-1v-21l-6-6zM16 26l-10-8h6v-6h8v6h6l-10 8zM4.828 6l2-2h18.343l2 2h-22.343z"></path>
                                                            </svg>
                            </span> Deposits </a>
                      </li>
                      <li>
                          <a href="03_withdrawals.html"> 
                            <span class="icon">
                              <svg 
                              width="32"
                              height="32"
                              viewBox="0 0 32 32"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg">
                                <path d="M26 2h-20l-6 6v21c0 0.552 0.448 1 1 1h30c0.552 0 1-0.448 1-1v-21l-6-6zM20 20v6h-8v-6h-6l10-8 10 8h-6zM4.828 6l2-2h18.343l2 2h-22.343z"></path>
                              </svg>
                            </span>Withdrawals </a>
                      </li>
                  </ul>                                           
              </li>

              <li class="nav-item nav-item-has-children">
                <a href="#0" class="collapsed" data-bs-toggle="collapse" data-bs-target="#ddmenu_3" aria-controls="ddmenu_3" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="icon">
                      <svg 
                      width="32"
                      height="32"
                      viewBox="0 0 32 32"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.366 22.564l1.291-1.807-1.414-1.414-1.807 1.291c-0.335-0.187-0.694-0.337-1.071-0.444l-0.365-2.19h-2l-0.365 2.19c-0.377 0.107-0.736 0.256-1.071 0.444l-1.807-1.291-1.414 1.414 1.291 1.807c-0.187 0.335-0.337 0.694-0.443 1.071l-2.19 0.365v2l2.19 0.365c0.107 0.377 0.256 0.736 0.444 1.071l-1.291 1.807 1.414 1.414 1.807-1.291c0.335 0.187 0.694 0.337 1.071 0.444l0.365 2.19h2l0.365-2.19c0.377-0.107 0.736-0.256 1.071-0.444l1.807 1.291 1.414-1.414-1.291-1.807c0.187-0.335 0.337-0.694 0.444-1.071l2.19-0.365v-2l-2.19-0.365c-0.107-0.377-0.256-0.736-0.444-1.071zM7 27c-1.105 0-2-0.895-2-2s0.895-2 2-2 2 0.895 2 2-0.895 2-2 2zM32 12v-2l-2.106-0.383c-0.039-0.251-0.088-0.499-0.148-0.743l1.799-1.159-0.765-1.848-2.092 0.452c-0.132-0.216-0.273-0.426-0.422-0.629l1.219-1.761-1.414-1.414-1.761 1.219c-0.203-0.149-0.413-0.29-0.629-0.422l0.452-2.092-1.848-0.765-1.159 1.799c-0.244-0.059-0.492-0.109-0.743-0.148l-0.383-2.106h-2l-0.383 2.106c-0.251 0.039-0.499 0.088-0.743 0.148l-1.159-1.799-1.848 0.765 0.452 2.092c-0.216 0.132-0.426 0.273-0.629 0.422l-1.761-1.219-1.414 1.414 1.219 1.761c-0.149 0.203-0.29 0.413-0.422 0.629l-2.092-0.452-0.765 1.848 1.799 1.159c-0.059 0.244-0.109 0.492-0.148 0.743l-2.106 0.383v2l2.106 0.383c0.039 0.251 0.088 0.499 0.148 0.743l-1.799 1.159 0.765 1.848 2.092-0.452c0.132 0.216 0.273 0.426 0.422 0.629l-1.219 1.761 1.414 1.414 1.761-1.219c0.203 0.149 0.413 0.29 0.629 0.422l-0.452 2.092 1.848 0.765 1.159-1.799c0.244 0.059 0.492 0.109 0.743 0.148l0.383 2.106h2l0.383-2.106c0.251-0.039 0.499-0.088 0.743-0.148l1.159 1.799 1.848-0.765-0.452-2.092c0.216-0.132 0.426-0.273 0.629-0.422l1.761 1.219 1.414-1.414-1.219-1.761c0.149-0.203 0.29-0.413 0.422-0.629l2.092 0.452 0.765-1.848-1.799-1.159c0.059-0.244 0.109-0.492 0.148-0.743l2.106-0.383zM21 15.35c-2.402 0-4.35-1.948-4.35-4.35s1.948-4.35 4.35-4.35 4.35 1.948 4.35 4.35c0 2.402-1.948 4.35-4.35 4.35z"></path>
                    
                        </svg>
                        
                    </span>
                <span class="text">Settings</span>
                </a>
                <ul id="ddmenu_3" class="collapse dropdown-nav">
                    <li>
                        <a href="04_settings.html">
                          <span class="icon">
                            <svg 
                            width="32"
                            height="32"
                            viewBox="0 0 32 32"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                              
                              
                              <path d="M18 22.082v-1.649c2.203-1.241 4-4.337 4-7.432 0-4.971 0-9-6-9s-6 4.029-6 9c0 3.096 1.797 6.191 4 7.432v1.649c-6.784 0.555-12 3.888-12 7.918h28c0-4.030-5.216-7.364-12-7.918z"></path>
                            
                              </svg>
                              
                          </span>
                          Users </a>
                        <a href="05_faucet.html"> 
                          <span class="icon">
                            <svg width="32"
                            height="32"
                            viewBox="0 0 32 32"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                              
                              <path d="M20 4.581v4.249c1.131 0.494 2.172 1.2 3.071 2.099 1.889 1.889 2.929 4.4 2.929 7.071s-1.040 5.182-2.929 7.071c-1.889 1.889-4.4 2.929-7.071 2.929s-5.182-1.040-7.071-2.929c-1.889-1.889-2.929-4.4-2.929-7.071s1.040-5.182 2.929-7.071c0.899-0.899 1.94-1.606 3.071-2.099v-4.249c-5.783 1.721-10 7.077-10 13.419 0 7.732 6.268 14 14 14s14-6.268 14-14c0-6.342-4.217-11.698-10-13.419zM14 0h4v16h-4z"/>
                              
                              </svg>
                              
                          </span>
                          Faucet </a>
                    </li>                          
                </ul>
            </li>      

            <li class="nav-item nav-item-has-children">
              <a href="#0" class="collapsed" data-bs-toggle="collapse" data-bs-target="#ddmenu_4" aria-controls="ddmenu_4" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="icon">
                    <svg  width="32"
                                height="32"
                                viewBox="0 0 32 32"
                                fill="none"   xmlns="http://www.w3.org/2000/svg">
                      <path d="M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM16 30c-1.967 0-3.84-0.407-5.538-1.139l7.286-8.197c0.163-0.183 0.253-0.419 0.253-0.664v-3c0-0.552-0.448-1-1-1-3.531 0-7.256-3.671-7.293-3.707-0.188-0.188-0.442-0.293-0.707-0.293h-4c-0.552 0-1 0.448-1 1v6c0 0.379 0.214 0.725 0.553 0.894l3.447 1.724v5.871c-3.627-2.53-6-6.732-6-11.489 0-2.147 0.484-4.181 1.348-6h3.652c0.265 0 0.52-0.105 0.707-0.293l4-4c0.188-0.188 0.293-0.442 0.293-0.707v-2.419c1.268-0.377 2.61-0.581 4-0.581 2.2 0 4.281 0.508 6.134 1.412-0.13 0.109-0.256 0.224-0.376 0.345-1.133 1.133-1.757 2.64-1.757 4.243s0.624 3.109 1.757 4.243c1.139 1.139 2.663 1.758 4.239 1.758 0.099 0 0.198-0.002 0.297-0.007 0.432 1.619 1.211 5.833-0.263 11.635-0.014 0.055-0.022 0.109-0.026 0.163-2.541 2.596-6.084 4.208-10.004 4.208z"></path>
                 
                      </svg>
                      
                  </span>
              <span class="text">Community</span>
              </a>
              <ul id="ddmenu_4" class="collapse dropdown-nav">
                  <li>
                      <a href="https://github.com/cryptotwilight/tresoreria" target="_blank"> 
                        <span class="icon">
                          <svg  width="32"
                                height="32"
                                viewBox="0 0 32 32"
                                fill="none"   xmlns="http://www.w3.org/2000/svg">

                            <path d="M16 0.395c-8.836 0-16 7.163-16 16 0 7.069 4.585 13.067 10.942 15.182 0.8 0.148 1.094-0.347 1.094-0.77 0-0.381-0.015-1.642-0.022-2.979-4.452 0.968-5.391-1.888-5.391-1.888-0.728-1.849-1.776-2.341-1.776-2.341-1.452-0.993 0.11-0.973 0.11-0.973 1.606 0.113 2.452 1.649 2.452 1.649 1.427 2.446 3.743 1.739 4.656 1.33 0.143-1.034 0.558-1.74 1.016-2.14-3.554-0.404-7.29-1.777-7.29-7.907 0-1.747 0.625-3.174 1.649-4.295-0.166-0.403-0.714-2.030 0.155-4.234 0 0 1.344-0.43 4.401 1.64 1.276-0.355 2.645-0.532 4.005-0.539 1.359 0.006 2.729 0.184 4.008 0.539 3.054-2.070 4.395-1.64 4.395-1.64 0.871 2.204 0.323 3.831 0.157 4.234 1.026 1.12 1.647 2.548 1.647 4.295 0 6.145-3.743 7.498-7.306 7.895 0.574 0.497 1.085 1.47 1.085 2.963 0 2.141-0.019 3.864-0.019 4.391 0 0.426 0.288 0.925 1.099 0.768 6.354-2.118 10.933-8.113 10.933-15.18 0-8.837-7.164-16-16-16z"></path>
                          </svg> 
                        </span> Github </a>
                      <a href="https://youtu.be/_KzR--PY7w4" target="_blank" > 
                        <span class="icon">
                          <svg   
                          width="32"
                          height="32"
                          viewBox="0 0 32 32"
                          fill="none"   xmlns="http://www.w3.org/2000/svg">
                            
                            
                            <path d="M30.662 5.003c-4.488-0.645-9.448-1.003-14.662-1.003s-10.174 0.358-14.662 1.003c-0.86 3.366-1.338 7.086-1.338 10.997s0.477 7.63 1.338 10.997c4.489 0.645 9.448 1.003 14.662 1.003s10.174-0.358 14.662-1.003c0.86-3.366 1.338-7.086 1.338-10.997s-0.477-7.63-1.338-10.997zM12 22v-12l10 6-10 6z"/>
                            
                            
                            </svg>
                            
                        </span>  
                        Youtube </a>
                  </li>                          
              </ul>
          </li>
            <span class="divider"><hr /></span>

          </ul>
      </nav>

  </aside>
  <div class="overlay"></div>
    <!-- ======== sidebar-nav end =========== -->

    <!-- ======== main-wrapper start =========== -->
    <main class="main-wrapper">
        <!-- ========== header start ========== -->
        <header class="header">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-5 col-md-5 col-6">
                        <div class="header-left d-flex align-items-center">
                            <div class="menu-toggle-btn mr-20">
                                <button id="menu-toggle" class="main-btn secondary-btn square-btn btn-hover">
                  <i class="lni lni-chevron-left me-2"></i> Menu
                </button>
                            </div>

                        </div>
                    </div>
                    <div class="col-lg-7 col-md-7 col-6">
                        <div class="header-right">
                            <!-- web 3 start -->
                            <div class="menu-toggle-btn mr-20"></div>
                            <a href="#" id="connect_web_3" rel="nofollow" class="main-btn secondary-btn rounded-md btn-hover">
                            Connect Web 3                              
                           
                          </a>
                        </div>
                        <span id="show_wallet"></span>
                    </div>
                </div>
            </div>
            </div>
        </header>
        <!-- ========== header end ========== -->

        <!-- ========== section start ========== -->
        <section class="section">
            <div class="container-fluid">
                <!-- ========== title-wrapper start ========== -->
                <div class="title-wrapper pt-30">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <div class="title mb-30">
                                <h2>Withdrawals Manager</h2>
                            </div>
                        </div>
                        <!-- end col -->
                        <div class="col-md-6">
                            <div class="breadcrumb-wrapper mb-30">
                                <nav aria-label="breadcrumb">
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item">
                                            <a href="#0">Management</a>
                                        </li>
                                        <li class="breadcrumb-item active" aria-current="page">
                                            Withdrawals
                                        </li>
                                    </ol>
                                </nav>
                            </div>
                        </div>
                        <!-- end col -->
                    </div>
                    <!-- end row -->
                </div>
                <!-- ========== title-wrapper end ========== -->
                <div class="row">
                    <div class="col-xl-3 col-lg-4 col-sm-6">

                    </div>
                    <!-- End Col -->
                    <div class="col-xl-6 col-lg-4 col-sm-6">
                        <div class="icon-card mb-30">
                            <center>
                                <table>
                                    <tr>
                                        <td>
                                            <div class="input-style-1">
                                                <label>Withdrawal Amount </label>
                                                <input type="text" placeholder="Enter withdrawal amount ..." id="withdrawal_amount" />
                                            </div>
                                        </td>
                                        <td>
                                            &nbsp;
                                        </td> 
                                        <td>
                                            <div class="select-style-1">
                                                <label>Withdrawal Currency </label>
                                                <div class="select-position">
                                                    <select id="withdraw_currency_select" onclick="switchCurrency()">
                                                      <option value="NONE">Select Currency</option>
                                                      <option value="USDC">USDC</option>
                                                      <option value="ETH">ETH</option>
                                                      <option value="DAI">DAI</option>
                                                      <option value="USDT">USDT</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            &nbsp;USD $<span id="withdrawal_total_denominated">0.00000</span>&nbsp;
                                        </td>
                                        <td>
                                            <div class="input-style-1">
                                                <label>Withdrawal Address </label>
                                                <input type="text" placeholder="Enter withdrawal address 0x ..." id="withdrawal_address" />
                                            </div>
                                        </td>
                                        <td>
                                            &nbsp;
                                        </td>
                                        <td>
                                            <a href="#" id="withdraw_button" rel="nofollow" class="main-btn secondary-btn rounded-md btn-hover">Withdraw</a>
                                        </td>
                                    </tr>
                                    <tr> 
                                      <td></td>
                                      <td></td>
                                      <td><center>Rate: <span id="withdrawal_currency_exchange_rate">$0.00</span></center></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                      <td></td>
                                    </tr>
                                </table>
                            </center>

                        </div>
                        <!-- End Icon Cart -->
                    </div>
                    <!-- End Col -->


                    <div class="col-xl-3 col-lg-4 col-sm-6">

                    </div>
                    <!-- End Col -->
                </div>
                <!-- End Row -->


                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <div class="left">
                                <h6 class="text-medium mb-30">Available Balances</h6>
                            </div>

                            <div class="table-responsive">
                                <table class="table top-selling-table" id="available_balances_table">
                                    <thead>
                                        <tr>
                                            <th>
                                                <h6 class="text-sm text-medium">Currency</h6>
                                            </th>
                                            <th class="min-width">
                                                <h6 class="text-sm text-medium">
                                                    Balance <i class="lni lni-arrows-vertical"></i>
                                                </h6>
                                            </th>
                                            <th class="min-width">
                                                <h6 class="text-sm text-medium">
                                                    Denominated <i class="lni lni-arrows-vertical"></i>
                                                </h6>
                                            </th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                       
                                    </tbody>
                                </table>
                                <!-- End Table -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- End Row -->


                <div class="row">

                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <div class="
            title
            d-flex
            flex-wrap
            justify-content-between
            align-items-center
          ">
                                <div class="left">
                                    <h6 class="text-medium mb-30">Withdrawal History</h6>
                                </div>

                            </div>
                            <!-- End Title -->
                            <div class="table-responsive" >
                                <table class="table top-selling-table" id="withdrawal_history_table">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>
                                                <h6 class="text-sm text-medium">Currency</h6>
                                            </th>
                                            <th class="min-width">
                                                <h6 class="text-sm text-medium">Amount</h6>
                                            </th>
                                            <th class="min-width">
                                                <h6 class="text-sm text-medium">Denominated</h6>
                                            </th>
                                            <th class="min-width">
                                                <h6 class="text-sm text-medium">Date</h6>
                                            </th>
                                            <th class="min-width">
                                                <h6 class="text-sm text-medium">Withdrawer</h6>
                                            </th>
                                            <th>
                                                <h6 class="text-sm text-medium">Payee Address</h6>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>

                                    </tbody>
                                </table>
                                <!-- End Table -->
                            </div>
                        </div>
                    </div>
                    <!-- End Col -->
                </div>
                <!-- End Row -->

            </div>
            <!-- end container -->
        </section>
        <!-- ========== section end ========== -->

        <!-- ========== footer start =========== -->
        <footer class="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-6 order-last order-md-first">
                        <div class="copyright text-center text-md-start">
                            <p class="text-sm">
                                Designed and Developed by
                                <a href="https://www.blockstarlogic.com" rel="nofollow" target="_blank">
      Block Star Logic
    </a>
                            </p>
                        </div>
                    </div>
                    <!-- end col-->
                    <div class="col-md-6">
                        <div class="
                  terms
                  d-flex
                  justify-content-center justify-content-md-end
                ">
                            <a href="#0" class="text-sm">Term & Conditions</a>
                            <a href="#0" class="text-sm ml-15">Privacy & Policy</a>
                        </div>
                    </div>
                </div>
                <!-- end row -->
            </div>
            <!-- end container -->
        </footer>
        <!-- ========== footer end =========== -->
    </main>
    <!-- ======== main-wrapper end =========== -->

    <!-- ========= All Javascript files linkup ======== -->
    <script src="../assets/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/Chart.min.js"></script>
    <script src="../assets/js/dynamic-pie-chart.js"></script>
    <script src="../assets/js/moment.min.js"></script>
    <script src="../assets/js/fullcalendar.js"></script>
    <script src="../assets/js/jvectormap.min.js"></script>
    <script src="../assets/js/world-merc.js"></script>
    <script src="../assets/js/polyfill.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/ierc20abi.js"></script>

    <script>
      const iTresoreriaAbi = [
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_amount",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "_denominated",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "_currency",
				"type": "string"
			},
			{
				"internalType": "address",
				"name": "_erc20",
				"type": "address"
			}
		],
		"name": "deposit",
		"outputs": [
			{
				"internalType": "bool",
				"name": "_deposited",
				"type": "bool"
			}
		],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_protocol",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_market",
				"type": "string"
			}
		],
		"name": "exit",
		"outputs": [
			{
				"internalType": "bool",
				"name": "_liquidated",
				"type": "bool"
			},
			{
				"internalType": "string",
				"name": "_currency",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "_amount",
				"type": "uint256"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getApprovedAddresses",
		"outputs": [
			{
				"internalType": "address[]",
				"name": "_approvedAddress",
				"type": "address[]"
			},
			{
				"internalType": "string[]",
				"name": "_addressName",
				"type": "string[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getAvailableBalances",
		"outputs": [
			{
				"internalType": "string[]",
				"name": "_currency",
				"type": "string[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_balance",
				"type": "uint256[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getDepositHistory",
		"outputs": [
			{
				"internalType": "string[]",
				"name": "_currency",
				"type": "string[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_volume",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_denominated",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "depositDate",
				"type": "uint256[]"
			},
			{
				"internalType": "address[]",
				"name": "_payer",
				"type": "address[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getHoldings",
		"outputs": [
			{
				"internalType": "string[]",
				"name": "_protocol",
				"type": "string[]"
			},
			{
				"internalType": "string[]",
				"name": "_market",
				"type": "string[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_rateYield",
				"type": "uint256[]"
			},
			{
				"internalType": "bool[]",
				"name": "_isAPY",
				"type": "bool[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_volume",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_earningsToDate",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_initialInvestment",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_investmentDate",
				"type": "uint256[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getInvestmentHistory",
		"outputs": [
			{
				"internalType": "string[]",
				"name": "_protocol",
				"type": "string[]"
			},
			{
				"internalType": "string[]",
				"name": "_market",
				"type": "string[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_entryDate",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_exitDate",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_entryInvestment",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_entryInvestmentDenominated",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_exitReturn",
				"type": "uint256[]"
			},
			{
				"internalType": "string[]",
				"name": "_exitCurrency",
				"type": "string[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getLatestDeals",
		"outputs": [
			{
				"internalType": "string[]",
				"name": "_protocol",
				"type": "string[]"
			},
			{
				"internalType": "string[]",
				"name": "_market",
				"type": "string[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_aprapy",
				"type": "uint256[]"
			},
			{
				"internalType": "bool[]",
				"name": "_isAPYs",
				"type": "bool[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_totalValueLocked",
				"type": "uint256[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getSwapHistory",
		"outputs": [
			{
				"internalType": "string[]",
				"name": "_fromCurrency",
				"type": "string[]"
			},
			{
				"internalType": "string[]",
				"name": "_toCurrency",
				"type": "string[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_fromCurrencyAmount",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_toCurrencyAmount",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_fromCurrencyAmountDenominated",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_swapDate",
				"type": "uint256[]"
			},
			{
				"internalType": "address[]",
				"name": "_swapper",
				"type": "address[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getWithdrawalHistory",
		"outputs": [
			{
				"internalType": "string[]",
				"name": "_currency",
				"type": "string[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_volume",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_denominated",
				"type": "uint256[]"
			},
			{
				"internalType": "uint256[]",
				"name": "_withdrawalDate",
				"type": "uint256[]"
			},
			{
				"internalType": "address[]",
				"name": "_withdrawer",
				"type": "address[]"
			},
			{
				"internalType": "address[]",
				"name": "_payee",
				"type": "address[]"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_protocol",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_market",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "_amount",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "_denominated",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "_currency",
				"type": "string"
			},
			{
				"internalType": "address",
				"name": "_erc20",
				"type": "address"
			}
		],
		"name": "invest",
		"outputs": [
			{
				"internalType": "bool",
				"name": "_invested",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_fromCurrency",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "_toCurrency",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "_fromDenominated",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "_fromCurrencyAmount",
				"type": "uint256"
			}
		],
		"name": "swap",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "_toCurrencyAmount",
				"type": "uint256"
			}
		],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_amount",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "_denominated",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "_currency",
				"type": "string"
			},
			{
				"internalType": "address",
				"name": "_erc20",
				"type": "address"
			},
			{
				"internalType": "address payable",
				"name": "_payee",
				"type": "address"
			}
		],
		"name": "withdraw",
		"outputs": [
			{
				"internalType": "bool",
				"name": "_withdrawn",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	}
];
  </script>

    <script>

      const availableBalancesTable = document.getElementById("available_balances_table");
      const withdrawalHistoryTable = document.getElementById("withdrawal_history_table");

      const withdrawButton = document.getElementById("withdraw_button");
      withdrawButton.setAttribute("onclick","withdraw()");
      const withdrawalAddress = document.getElementById("withdrawal_address");

      const withdrawalTotalDenominated = document.getElementById("withdrawal_total_denominated");
      const withdrawalCurrencySelect = document.getElementById("withdraw_currency_select");

      const withdrawalAmount = document.getElementById("withdrawal_amount");
      const withdrawalCurrencyExchangeRate = document.getElementById("withdrawal_currency_exchange_rate");
        
      async function switchCurrency() { 
        var selectedWithdrawalCurrency = withdrawalCurrencySelect.value; 
        if(selectedWithdrawalCurrency == 'NONE') {
          return null; 
        }
        var amountToWithdraw = withdrawalAmount.value; 
        if(amountToWithdraw <= 0) {
          return null;
        }

        fetchPrice(selectedWithdrawalCurrency, withdrawalCurrencyExchangeRate);
        fetchPriceAndMultiply(selectedWithdrawalCurrency, withdrawalTotalDenominated, amountToWithdraw);

      }      

      function findLogoPath(currency){
        return "../assets/images/currencies/"+currency.toLowerCase()+".png"; 
      }
      const currencies = { "AAVE":"Aave Token","ETH" : "Ethereum", "USDC" : "USD Coin", "USDT": "Tether USD", "DAI" : "Multi Collateral DAI" };
      function findCurrencyName(currency) {
        return currencies[currency];
      }

      function createDiv(classNam) {
        var div = document.createElement("div");
        div.setAttribute("class", classNam);
        return div; 
      }

      function createP(){
        var p = document.createElement("p");
        p.setAttribute("class","text-sm");
        return p; 
      }

      function formatDate(date ){
            return new Date(date*1000).toISOString();
      }

      function addAvailableBalance(currency, balance ){ 
          var row = availableBalancesTable.insertRow(); 
          
          var currencyCell = row.insertCell();
          var currencyLogoPath = findLogoPath(currency);
          
          var image = document.createElement("img");
          image.setAttribute("src",currencyLogoPath);
          image.setAttribute("alt",currency);
          var currencyImageDiv = createDiv("image");
          currencyImageDiv.appendChild(image);

          var currencyName = findCurrencyName(currency);
          var currencyNameP = createP();
          var currencyNameTxt = document.createTextNode(currencyName);
          currencyNameP.appendChild(currencyNameTxt);

          var holderDiv = createDiv("product");
          holderDiv.appendChild(currencyImageDiv);
          holderDiv.appendChild(currencyNameP);
          currencyCell.appendChild(holderDiv);
          
          var currencyBalanceCell = row.insertCell();
          var currencyBalanceP = createP(); 
          var currencyBalanceTxt = document.createTextNode(balance);
          currencyBalanceP.appendChild(currencyBalanceTxt);
          currencyBalanceCell.appendChild(currencyBalanceP);

          var currencyBalanceDenominatedCell = row.insertCell();
          var currencyBalanceDenominatedP = createP(); 
          currencyBalanceDenominatedCell.appendChild(currencyBalanceDenominatedP);
          fetchPriceAndMultiply(currency, currencyBalanceDenominatedP, balance);   
              
      }


      function addWithdrawalHistory(currency, amount, denominated, date, withdrawer, payee) { 
         var row = withdrawalHistoryTable.insertRow(); 
         
          row.insertCell();
          var currencyCell = row.insertCell();
          var currencyLogoPath = findLogoPath(currency);
          
          var image = document.createElement("img");
          image.setAttribute("src",currencyLogoPath);
          image.setAttribute("alt",currency);
          var currencyImageDiv = createDiv("image");
          currencyImageDiv.appendChild(image);

          var currencyName = findCurrencyName(currency);
          var currencyNameP = createP();
          var currencyNameTxt = document.createTextNode(currencyName);
          currencyNameP.appendChild(currencyNameTxt);

          var holderDiv = createDiv("product");
          holderDiv.appendChild(currencyImageDiv);
          holderDiv.appendChild(currencyNameP);
          currencyCell.appendChild(holderDiv);

          var currencyAmountCell = row.insertCell();
          var currencyAmountP = createP(); 
          var currencyAmountTxt = document.createTextNode(amount);
          currencyAmountP.appendChild(currencyAmountTxt);
          currencyAmountCell.appendChild(currencyAmountP);

          var currencyAmountDenominatedCell = row.insertCell();
          var currencyAmountDenominatedP = createP(); 
          var currencyAmountDenominatedTxt = document.createTextNode(denominated);
          currencyAmountDenominatedP.appendChild(currencyAmountDenominatedTxt);
          currencyAmountDenominatedCell.appendChild(currencyAmountDenominatedP);

          var withdrawDateCell = row.insertCell();
          var withdrawDateP = createP(); 
          var withdrawDateTxt = document.createTextNode(formatDate(date));
          withdrawDateP.appendChild(withdrawDateTxt);
          withdrawDateCell.appendChild(withdrawDateP);

          var withdrawerCell = row.insertCell();
          var withdrawerP = createP(); 
          var withdrawerTxt = document.createTextNode(withdrawer);
          withdrawerP.appendChild(withdrawerTxt);
          withdrawerCell.appendChild(withdrawerP);

          var payeeCell = row.insertCell();
          var payeeP = createP(); 
          var payeeTxt = document.createTextNode(payee);
          payeeP.appendChild(payeeTxt);
          payeeCell.appendChild(payeeP);
          row.insertCell();

      }

      var account;

      const onboardButton = document.getElementById("connect_web_3");
      const showWallet = document.getElementById("show_wallet");

      const web3 = new Web3(window.ethereum);
      const tresoreriaAddress = "0x8436f06AAAc5D4a98869448EE3e5D5231701eE1D";

      const tresoreriaContract = new web3.eth.Contract(iTresoreriaAbi, tresoreriaAddress);


      //Created check function to see if the MetaMask extension is installed
      const isMetaMaskInstalled = () => {

          const {
              ethereum
          } = window;
          return Boolean(ethereum && ethereum.isMetaMask);
      };

      const MetaMaskClientCheck = () => {
          //Now we check to see if Metmask is installed
          if (!isMetaMaskInstalled()) {
              console.log("metamask not installed");
              //If it isn't installed we ask the user to click to install it
              onboardButton.innerText = 'Click here to install MetaMask!';
              //When the button is clicked we call this function
              onboardButton.onclick = onClickInstall;
              //The button is now disabled
              onboardButton.disabled = false;
          } else {
              //If it is installed we change our button text
              onboardButton.innerText = 'Click to Connect Metamask';
              console.log("metamask installed");
              onboardButton.addEventListener('click', () => {
                  getAccount();
                  onboardButton.innerText = "Web 3 Connected";
              });
          }
      };

      const initialize = () => {
          MetaMaskClientCheck();
          getAvailableBalances ();
          getWithdrawalHistory();
          loaded = true; 
      };

      window.addEventListener('DOMContentLoaded', initialize);

      async function getAccount() {
          const accounts = await ethereum.request({
              method: 'eth_requestAccounts'
          });
          account = accounts[0];
          showWallet.innerHTML = "<b>Connected Wallet :: " + account + "</b>";
      }

      //We create a new MetaMask onboarding object to use in our app
      //const onboarding = new MetaMaskOnboarding({ forwarderOrigin });

      //This will start the onboarding proccess
      const onClickInstall = () => {
          onboardButton.innerText = 'Onboarding in progress';
          onboardButton.disabled = true;
          //On this object we have startOnboarding which will start the onboarding process for our end user
          onboarding.startOnboarding();
      };

      const onClickConnect = async() => {
          try {
              // Will open the MetaMask UI
              // You should disable this button while the request is pending!
              await ethereum.request({
                  method: 'eth_requestAccounts'
              });
          } catch (error) {
              console.error(error);
          }
      };



      async function fetchPriceAndMultiply(currency, node, amount) {
          var url = "https://api.covalenthq.com/v1/pricing/tickers/?tickers=" + currency + "&quote-currency=USD&format=JSON&key=ckey_43370c93a0914e429ae00eca81d";
          fetch(url).then(function(response) {
                  respData = response.json();
                  console.log("response data :- ");
                  console.log(respData);
                  return respData
              })
              .then(function(data) {
                node.innerHTML = ""
                  console.log("processing data");
                  console.log(data.data);
                  var price = "" + (data.data.items[0].quote_rate * amount) + "";
                  console.log("price: " + price);
                  var priceTxt = document.createTextNode(price);
                  node.appendChild(priceTxt);
                  return price;
              })
              .catch(function(err) {
                  console.log(err);
              });
      }

      async function fetchPrice(currency, node) {
          var url = "https://api.covalenthq.com/v1/pricing/tickers/?tickers=" + currency + "&quote-currency=USD&format=JSON&key=ckey_43370c93a0914e429ae00eca81d";
          fetch(url).then(function(response) {
                  respData = response.json();
                  console.log("response data :- ");
                  console.log(respData);
                  return respData
              })
              .then(function(data) {
                node.innerHTML = ""; 
                  console.log("processing data");
                  console.log(data.data);
                  var price = "" + data.data.items[0].quote_rate + "";
                  console.log("price: " + price);
                  var priceTxt = document.createTextNode(price);
                  node.appendChild(priceTxt);
                  return price;
              })
              .catch(function(err) {
                  console.log(err);
              });
      }
      
  </script>
  <script> 
        function outboundNumber( num ) {
            return (num * 1e18);
        }

        function inboundNumber( num ) {
            return num / 1e18; 
        }

        function toString(num) {
            return num+"";
        }

      function clear() { 
        withdrawalAddress.value = ""; 
        withdrawalAmount.value = ""; 
        withdrawalCurrencySelect.clear; 
        withdrawalTotalDenominated.innerHTML = "0.00";
        withdrawalCurrencyExchangeRate.innerHTML = "0.00"; 
      }
      
      function refresh() { 
        clear();
        deleteRows(availableBalancesTable);
        deleteRows(withdrawalHistoryTable);
        loaded = false; 
        getAvailableBalances ();
        getWithdrawalHistory();
       
      }

      function deleteRows(table) {
        var len = table.rows.len; 
        for(x = 1; x < len; x++){
          table.deleteRow(1);
        }
      }

      const supporedERC20Addresses = {
            "AAVE": "0x2a9990C731924bE3Ce1f1AD460c50284DBdD9568",
            "ETH": "0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",
            "USDC": "0x39a3ECe41258C5177a248DaE6F6b714811d9b03B",
            "DAI": "0xA5B7045EBfd88D6677cBa5787DCBdE66e3243aFd",
            "USDT": "0x752Cd4aE72A85bAa4B6E86b2cAAE107963ce801C"
      };

      async function withdraw() { 

            var w = withdrawalAmount.value;
            var _amount = outboundNumber(w);            
            var _currency = withdrawalCurrencySelect.value;
            var _erc20 = supporedERC20Addresses[_currency];
            var _payee = withdrawalAddress.value; 
            
            var url = "https://api.covalenthq.com/v1/pricing/tickers/?tickers=" + _currency + "&quote-currency=USD&format=JSON&key=ckey_43370c93a0914e429ae00eca81d";
            fetch(url).then(function(response) {
                    respData = response.json();
                    console.log("response data :- ");
                    console.log(respData);
                    return respData
                })
                .then(function(data) {
                    
                    var _denominated = outboundNumber(data.data.items[0].quote_rate * w );
                       
                    console.log(" " + _amount + " :: " + _denominated + " :: " + _currency + " :: " + _erc20);

                    tresoreriaContract.methods.withdraw(toString(_amount), toString(_denominated), _currency, _erc20, _payee ).send({
                            from: account
                        })
                        .then(function(response) {
                            console.log(response);
                           refresh(); 
                        })
                        .catch(function(err) {
                            console.log(err);
                        });
                        
                    })                    
                .catch(function(err) {
                    console.log(err);
                });
      }
    var availableBalancesLoaded = false; 
    async function getAvailableBalances () { 
      if(!availableBalancesLoaded) {
        tresoreriaContract.methods.getAvailableBalances().call({
                from: account
            })
        .then(function(response){
            console.log(response);
            var currencies = response._currency; 
            var balances = response._balance; 
            for(var x = 0; x < currencies.length; x++){
                addAvailableBalance(currencies[x], inboundNumber(balances[x]));
            }
            availableBalancesLoaded = true; 
        });
      }
    }
    var withdrawalHistoryLoaded = false; 
    async function getWithdrawalHistory() { 
      if(!withdrawalHistoryLoaded) {
        tresoreriaContract.methods.getWithdrawalHistory().call({
            from: account
        })
        .then(function(response){
            console.log(response);
            var currency = response._currency; 
            var amount = response._volume; 
            var denominated = response._denominated; 
            var date = response._withdrawalDate; 
            var withdrawer = response._withdrawer; 
            var payee = response._payee; 

            for(var x = 0; x < currency.length; x++){
                addWithdrawalHistory(currency[x], inboundNumber(amount[x]), inboundNumber(denominated[x]), date[x], withdrawer[x], payee[x]);
            }
            withdrawalHistoryLoaded = true; 
        });
        
      }
    }
  
  </script>

</body>

</html>